<?xml version="1.0" encoding="UTF-8"?>
<mapper namespace="com.ssafy.musical.mapper.MusicalMapper">


	<select id="selectAllMusical" resultType="com.ssafy.curtaincall.musical.Musical">
		SELECT * FROM musical
	</select>
	
	<select id="selectMusical" parameterType="int" resultType="com.ssafy.curtaincall.musical.Musical">
		SELECT * FROM musical
		WHERE musical_id = #{id}
	</select>
	
	<!-- 동적쿼리 : 검색 -->
	<select id="selectMusicalByCondition" resultType="com.ssafy.curtaincall.musical.Musical">
		<mapper namespace="com.ssafy.musical.mapper.MusicalMapper">

    <select id="search" resultType="Musical">
        SELECT *
        FROM musical
        <where>
            <if test="hashtags != null and hashtags.size() > 0">
                AND hashtag IN
                <foreach collection="hashtags" item="tag" open="(" separator="," close=")">
                    #{tag}
                </foreach>
            </if>
        </where>

        <choose>
            <when test="sortBy == 'random'">
                ORDER BY RAND()
            </when>
            <otherwise>
                ORDER BY ${sortBy} ${order}
            </otherwise>
        </choose>

    </select>

</mapper>

	</select>

</mapper>